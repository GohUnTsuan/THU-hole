{"code": 0, "data": [{"cid": 435681, "deleted": false, "image_metadata": {}, "is_dz": true, "name": "洞主", "pid": 90384, "reply_to": -1, "tag": null, "text": "举个例子：\n```go\nfunc doAttention(c *gin.Context) {\n\tpid, err := strconv.Atoi(c.PostForm(\"pid\"))\n\tif err != nil {\n\t\tutils.HttpReturnWithCodeOne(c, \"关注操作失败，pid不合法\")\n\t\treturn\n\t}\n\t_, _, _, _, _, _, _, _, _, err3 := db.GetOnePost(pid)\n\tif err3 != nil {\n\t\tutils.HttpReturnWithCodeOne(c, \"关注失败，pid不存在\")\n\t\treturn\n\t}\n\ts := c.PostForm(\"switch\")\n\ttoken := c.PostForm(\"user_token\")\n\temailHash, err5 := db.GetInfoByToken(token)\n\tif err5 != nil {\n\t\tutils.HttpReturnWithCodeOne(c, \"关注失败，请检查登录状态\")\n\t\treturn\n\t}\n\n\tcontext, err6 := doAttentionLimiter.Get(c, emailHash)\n\tif err6 != nil {\n\t\tc.AbortWithStatus(500)\n\t\treturn\n\t}\n\tif context.Reached {\n\t\tlog.Printf(\"do_attention limiter limiter reached\")\n\t\tutils.HttpReturnWithCodeOne(c, \"你今天关注太多树洞了，明天再来吧\")\n\t\treturn\n\t}\n\n\tisAttention, err2 := db.IsAttention(emailHash, pid)\n\tif err2 != nil {\n\t\tlog.Printf(\"error dbIsAttention while doAttention: %s\\n\", err2)\n\t\tutils.HttpReturnWithCodeOne(c, \"数据库读取失败，请联系管理员\")\n\t\treturn\n\t}\n\tif isAttention == 0 && s == \"0\" {\n\t\tutils.HttpReturnWithCodeOne(c, \"您已经取消关注了\")\n\t\treturn\n\t}\n\tif isAttention == 1 && s == \"1\" {\n\t\tutils.HttpReturnWithCodeOne(c, \"您已经关注过了\")\n\t\treturn\n\t}\n\tif isAttention == 0 {\n\t\t_, _ = db.AddAttentionIns.Exec(emailHash, pid)\n\t\t_, _ = db.PlusOneAttentionIns.Exec(pid)\n\t}\n\tif isAttention == 1 {\n\t\t_, _ = db.RemoveAttentionIns.Exec(emailHash, pid)\n\t\t_, _ = db.MinusOneAttentionIns.Exec(pid)\n\t}\n\n\tc.JSON(http.StatusOK, gin.H{\n\t\t\"code\": 0,\n\t})\n}\n```", "timestamp": 1602387082, "type": "text", "url": ""}, {"cid": 435691, "deleted": false, "image_metadata": {}, "is_dz": true, "name": "洞主", "pid": 90384, "reply_to": -1, "tag": null, "text": "这是树洞后端的一段代码，go语言写的。可以试一试能不能看懂。", "timestamp": 1602387154, "type": "text", "url": ""}, {"cid": 435698, "deleted": false, "image_metadata": {}, "is_dz": false, "name": "Alice", "pid": 90384, "reply_to": -1, "tag": null, "text": "有趣", "timestamp": 1602387227, "type": "text", "url": ""}, {"cid": 435700, "deleted": false, "image_metadata": {}, "is_dz": false, "name": "Bob", "pid": 90384, "reply_to": -1, "tag": null, "text": "阿哲", "timestamp": 1602387235, "type": "text", "url": ""}, {"cid": 435703, "deleted": false, "image_metadata": {}, "is_dz": false, "name": "Carol", "pid": 90384, "reply_to": -1, "tag": null, "text": "什么，关注量有上线？？", "timestamp": 1602387255, "type": "text", "url": ""}, {"cid": 435704, "deleted": false, "image_metadata": {}, "is_dz": false, "name": "Carol", "pid": 90384, "reply_to": -1, "tag": null, "text": "什么，关注量有上线？？", "timestamp": 1602387286, "type": "text", "url": ""}, {"cid": 435731, "deleted": false, "image_metadata": {}, "is_dz": true, "name": "洞主", "pid": 90384, "reply_to": -1, "tag": null, "text": "学会编程和学懂编程还是有区别的。一个合格的程序员都可以在半天内上手一门新语言。真正的编程需要掌握的概念就那些，变量，参数，返回值，调用，进程，递归等等。", "timestamp": 1602387744, "type": "text", "url": ""}, {"cid": 435745, "deleted": false, "image_metadata": {}, "is_dz": false, "name": "Dave", "pid": 90384, "reply_to": -1, "tag": null, "text": "Re 洞主: 看懂了……然而我只能算半个程序员……", "timestamp": 1602387929, "type": "text", "url": ""}, {"cid": 435779, "deleted": false, "image_metadata": {}, "is_dz": true, "name": "洞主", "pid": 90384, "reply_to": -1, "tag": null, "text": "Re Dave: 哈哈，之后都不难了，学习曲线就是开头这点陡而已", "timestamp": 1602388555, "type": "text", "url": ""}, {"cid": 435814, "deleted": false, "image_metadata": {}, "is_dz": true, "name": "洞主", "pid": 90384, "reply_to": -1, "tag": null, "text": "当然，如果是小众语法，小众语言的代码当我没说→_→", "timestamp": 1602389398, "type": "text", "url": ""}, {"cid": 435844, "deleted": false, "image_metadata": {}, "is_dz": false, "name": "Eve", "pid": 90384, "reply_to": -1, "tag": null, "text": "Re 洞主: dz认识有偏差，建议了解一些纯函数式语言", "timestamp": 1602389999, "type": "text", "url": ""}, {"cid": 435850, "deleted": false, "image_metadata": {}, "is_dz": false, "name": "Eve", "pid": 90384, "reply_to": -1, "tag": null, "text": "Re 洞主: 看得懂和用的好区别是很大的，用c++的习惯写python就会写出很不pythonic的代码", "timestamp": 1602390137, "type": "text", "url": ""}, {"cid": 435862, "deleted": false, "image_metadata": {}, "is_dz": true, "name": "洞主", "pid": 90384, "reply_to": -1, "tag": null, "text": "Re Eve: 用过LISP。我知道纯函数写起来会很爽，但终究函数式还是小众需求、小众应用范围。学会一门函数式再学别的也是一样的", "timestamp": 1602390339, "type": "text", "url": ""}, {"cid": 435870, "deleted": false, "image_metadata": {}, "is_dz": true, "name": "洞主", "pid": 90384, "reply_to": -1, "tag": null, "text": "Re Eve: 是啊，，，任何语言要用好了肯定都得深究的，并没有否认这一点。看懂只是保证“将将够用”", "timestamp": 1602390400, "type": "text", "url": ""}, {"cid": 435900, "deleted": false, "image_metadata": {}, "is_dz": false, "name": "Francis", "pid": 90384, "reply_to": -1, "tag": null, "text": "Go 的 Error Handling 设计真的糟糕", "timestamp": 1602390874, "type": "text", "url": ""}, {"cid": 435904, "deleted": false, "image_metadata": {}, "is_dz": false, "name": "Eve", "pid": 90384, "reply_to": -1, "tag": null, "text": "Re 洞主: 我觉得深入学习语言，窥探一些设计理念很有趣啊，谢谢dz的讨论", "timestamp": 1602390925, "type": "text", "url": ""}, {"cid": 435910, "deleted": false, "image_metadata": {}, "is_dz": false, "name": "Francis", "pid": 90384, "reply_to": -1, "tag": null, "text": "一看到 !=nil 就知道是Go了，即使没学过Go\ncz心中错误处理的优美程度排行：Rust >> C++, C#, Java, Python... > Go", "timestamp": 1602391015, "type": "text", "url": ""}, {"cid": 435935, "deleted": false, "image_metadata": {}, "is_dz": true, "name": "洞主", "pid": 90384, "reply_to": -1, "tag": null, "text": "Re Eve: 确实，我也很享受探索新语言的快感", "timestamp": 1602391375, "type": "text", "url": ""}, {"cid": 436012, "deleted": false, "image_metadata": {}, "is_dz": false, "name": "Grace", "pid": 90384, "reply_to": -1, "tag": null, "text": "哈哈哈哈 我学过Go", "timestamp": 1602392492, "type": "text", "url": ""}, {"cid": 436022, "deleted": false, "image_metadata": {}, "is_dz": false, "name": "Grace", "pid": 90384, "reply_to": -1, "tag": null, "text": "学了这么多语言 我觉得Rust 和 Haskell是最奇妙的语言", "timestamp": 1602392669, "type": "text", "url": ""}], "post": {"deleted": false, "image_metadata": {}, "likenum": 11, "pid": 90384, "reply": 20, "tag": null, "text": "判断一个人是否学懂编程的一个标准是：给他一段他没学过的语言的代码，看他能不能立刻读懂其字面上的逻辑。", "timestamp": 1602387036, "type": "text", "updated_at": 1606782634, "url": "", "vote": {}}}