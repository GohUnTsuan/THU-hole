{"code": 0, "data": [{"cid": 503544, "deleted": false, "image_metadata": {}, "is_dz": false, "name": "Alice", "pid": 104788, "reply_to": -1, "tag": null, "text": "就在这洞里面回复就行啊", "timestamp": 1604067058, "type": "text", "url": ""}, {"cid": 503556, "deleted": false, "image_metadata": {}, "is_dz": true, "name": "洞主", "pid": 104788, "reply_to": -1, "tag": null, "text": "Re Alice: 评论区也可以用markdown吗？啊我傻了抱歉……", "timestamp": 1604067264, "type": "text", "url": ""}, {"cid": 506796, "deleted": false, "image_metadata": {}, "is_dz": false, "name": "Bob", "pid": 104788, "reply_to": -1, "tag": null, "text": "#104574 的洞主来报道！！ 洞里真的都是大神。感谢大佬！", "timestamp": 1604155523, "type": "text", "url": ""}, {"cid": 513910, "deleted": false, "image_metadata": {}, "is_dz": true, "name": "洞主", "pid": 104788, "reply_to": -1, "tag": null, "text": "dz这几天下涩图一直用的这个程序  基本还是能能用的，但是会有一些玄学报错。比如莫名奇妙的下标出界，然后同样的程序再重新运行一遍，就没问题了，过几天有空再debug看看吧。", "timestamp": 1604389768, "type": "text", "url": ""}, {"cid": 526585, "deleted": false, "image_metadata": {}, "is_dz": true, "name": "洞主", "pid": 104788, "reply_to": -1, "tag": null, "text": "#104789 #104792 #104794", "timestamp": 1604736581, "type": "text", "url": ""}], "post": {"deleted": false, "image_metadata": {}, "likenum": 11, "pid": 104788, "reply": 5, "tag": "NSFW", "text": "#NSFW#\n#兔女郎与猫娘的日常#\n我是兔女郎与猫娘，#104574里说的代码我写好了……丑话先说在前面，dz没有接受过系统训练，学的专业和编程不沾边，学python依靠的全是b站上的教程和一颗lsp的心。这是我第一次写代码给别人用，肯定会各种bug满天飞，我尽量及时回复质疑，保证虚心接受批评。\n\n另外我发现树洞贴代码，如果一行代码太长的话排版会乱套，但是复制到python里缩进还是正常的，所以不用担心。由于单个树洞的字数限制，我不得不分成多个树洞发，大家自行在python里拼起来吧……\n```python\n# -*- coding: utf-8 -*-\n\"\"\"\nCreated on Fri Oct 30 15:54:40 2020\n\n@author: 兔女郎与猫娘\n\"\"\"\n####秀人网网址：https://www.xiurenji.com/\n\n#不知道这个网站的可以先去看看，熟悉一下，一般每个模特都有许多套图，每套图大概几十张照片\n\n####功能\n#主功能：输入女模特名字，搜索她的所有套图，并分组下载每一套图的所有图片\n#简化版：自己用浏览器搜索女模特，将搜索结果传回给程序，程序会分组下载她的每一套图的所有图片（这个简化版是为了不使用selenium）\n#简化-简化版：输入一套图的地址，下载这套图的所有图片\n\n####在开始前请确保您可以正常调用如下三个模块(必要)\nimport os\nimport requests\nimport math\n\n#然后还需要两个模块，如果不能调用需要看后面的简化版：\n####程序的批量下载功能依靠lxml模块实现，您可以尝试运行下面的'from lxml import etree'，导入失败说明需要先安装，可自行百度\n\n   #如果您不打算安装这个模块的话，可以跳到文末，那里有一个简化-简化版本的\n\n   #功能为输入单个套图网页地址，保存这一套图所有图片，也即无法一次下载许多套\nfrom lxml import etree\n\n####程序的搜索女模特功能依靠selenium模块实现，这个模块安装貌似稍微有点麻烦，可自行百度\n \n   #如果您不打算安装这个模块的话，也可以直接跳到文末，那里有一个简化版本的\n\n   #功能与这个类似，只是需要你自己用浏览器搜索好女模特然后把搜索结果传回来\nfrom selenium import webdriver\nfrom selenium.webdriver.common.keys import Keys#模拟按键\n\n#如果以上均可正常调用：\n#输入参数：\n#1、name:女模特在秀人网的艺名，例如糯美子、娜露或梦心月\n\n#2、model_path:下载地址文件夹，给出文件夹地址，程序会在这个目录下创建女优名字文件夹，再在女友文件夹中创建每组套图的文件夹，后续图片都会保存在这里\n\n#3、set_start:从第几套图开始下载，默认从第1套图开始。例如在秀人网搜索糯美子后会出现8页，每页10套图，从第23套开始下载也即从第3页第3套开始下载           \n\n#4、set_num:总共下载几套图，默认下载1套。如果想全部下载则输入max(尽量不要一次下载太多……)\n\n#5、notice:如果notice为yes，每下载完成一套图程序会停下询问是否继续。如果notice为no，下载完一套图会直接下载下一套\n    #建议选择yes，选择yes的话每下载完一套，还会问你下次下载完一套图还要不要询问，如果输入yes以后继续询问，如果输入no以后就不再询问了\n\n#输入范例1\n#name='糯美子',model_path='E:\\\\文件夹A',set_start=23,sat_num=4,notice='yes' \n#表示搜索糯美子，从第23套图开始，下载23、24、25、26共四套图，每下载完成一套询问我一次是否继续下载下一套，保存在E盘文件夹A里面\n\n\n#输入范例2\n#name='糯美子',model_path='E:\\\\文件夹A',set_start=2,sat_num='max',notice='no'  \n#表示搜索糯美子，从第2套图开始，下载后面的所有套图，每下载完成一套不用询问直接继续下载下一套，保存在E盘文件夹A里面\n\n####一些注意事项，一定要看！\n#1、不建议一次性下载超过5套图哦，工作量一大可能会出现各种卡死。可以一次性下载比如1~3，再下载4~5，安全一些\n\n#2、dz没有接受过系统训练，学编程全靠b站，这是第一次写程序给别人用，把你们电脑烧坏了概不负责！（我是认真的）\n\n#3、dz发现长时间不停下载时会玄学报错：由于连接方在一段时间后没有正确答复或连接的主机没有反应，连接尝试失败。可能是被反爬虫了，也可能单纯的是电脑太次，关掉重新运行一下就好啦\n\n####这一部分是爬虫主体，调用完成上面的模块后，运行这一部分\nclass modelspider(object):\n       def __init__(self,name,model_path,set_start=1,set_num=1,notice='yes'):\n              self.name=name#模特艺名\n              self.set_start=set_start#从第几组套图开始下载\n              self.set_num=set_num#下载set_num组套图，默认下载5套，如果全部下载则输入'max'\n              self.notice=notice#每下载完成一套图是否询问要不要继续\n              self.model_path=model_path#保存文件夹的目录\n              self.headers={#requests headers\n                            'Accept':\"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\",\n                            'Accept-Encoding':'gzip, deflate, br',\n                            'Accept-Language':\"zh-CN,zh;q=0.9\",\n                            'Cache-Control':\"max-age=0\",\n                            'Connection':\"keep-alive\",\n                            'Cookie':\"UM_distinctid=173d30553d544e-05e8d2425a679e-3323765-e1000-173d30553d64cf; __51cke__=; ASPSESSIONIDAWAADQTB=NIFBIBABGHEHMNBIFLHHLOJI; CNZZDATA1278618868=278254405-1596971648-https%253A%252F%252Fwww.baidu.com%252F%7C1603939602; __tins__20641871=%7B%22sid%22%3A%201603939974060%2C%20%22vd%22%3A%2020%2C%20%22expires%22%3A%201603942451275%7D; __51laig__=71\",\n                            'Host':\"www.xiurenji.com\",\n                            'Sec-Fetch-Dest':\"document\",\n                            'Sec-Fetch-Mode':\"navigate\",\n                            'Sec-Fetch-Site':\"none\",\n                            'Sec-Fetch-User':\"?1\",\n                            'Upgrade-Insecure-Requests':\"1\",\n                            'User-Agent':\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\",\n                            }\n              pass\n       def get_set_page_list(self):\n              #获取该模特最新的set_num组套图对应的网页地址，每页10套，输出set_num/10套\n              driver=webdriver.PhantomJS()\n              driver.get(\"https://www.xiurenji.com/plus/search/\")\n              #执行搜索\n              driver.find_element_by_xpath(\"//form[@action='index.asp']//input[@name='keyword']\").send_keys(self.name)\n              driver.find_element_by_xpath(\"//form[@action='index.asp']//input[@name='keyword']\").send_keys(Keys.RETURN)\n              html_search=(driver.page_source)#获取html内容\n              self.html_search=etree.HTML(html_search)\n              set_page_list=[]\n              #判断一下有没有足够多的set_num，如果没有则默认全下完\n              temp_num_max=len(self.html_search.xpath(\".//div[@class='page']//a/@href\"))\n              if temp_num_max==0:\n                     #没搜到\n                     self.set_page_list=set_page_list\n                     return\n              if (math.ceil((self.set_start+self.set_num-1)/10))>(temp_num_max):\n                     print('主人搜索的小姐姐没有'+str(self.set_num)+'组那么多套图哦，我默认下载全部啦~')\n                     self.set_num=='max'\n              if self.set_num=='max':              \n                     for i in self.html_search.xpath(\".//div[@class='page']//a/@href\")[math.ceil(self.set_start/10)-1:]:\n                            set_page_list.append('https://www.xiurenji.com/plus/search/index.asp'+i)\n                            pass\n                     pass\n              else:\n                     for i in self.html_search.xpath(\".//div[@class='page']//a/@href\")[math.ceil(self.set_start/10)-1:math.ceil((self.set_start+self.set_num-1)/10)]:\n                            set_page_list.append('https://www.xiurenji.com/plus/search/index.asp'+i)\n                            pass\n                     pass\n              self.set_page_list=set_page_list\n              driver.quit()#关闭模拟浏览器\n              return\n", "timestamp": 1604066948, "type": "text", "updated_at": 1606782636, "url": "", "vote": {}}}